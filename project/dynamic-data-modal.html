<html>
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=5" />
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
	</head>
	<body>
		<div id="dynamic-data-modal"></div>
	</body>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.14/es5-shim.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.14/es5-sham.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/json3/3.3.2/json3.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.5/es6-shim.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.5/es6-sham.min.js"></script>
	<script src="../library/dist/bundle.js"></script>
	<script>
		try {
		var library = window.Didgah4DynamicDataLibrary;
		var fields = dialogArguments.fields;
		var formId = library.elementIdGenerator.gererate();
		var form = library.createElement({tagName: 'form', props: {id: formId}});
		fields.map(function (field) {
			var wrap = library.createElement({ tagName: "div" });
			field.formData = dialogArguments.formData[field.name];
			if( field.Type.IsBundle) {
				var input =  dialogArguments.editCellRenderer(field).input;;
				wrap.appendChild(library.DynamicDataGrid({
					headers: ['a'],
					initialFormData: input.initialFormData,
					rowsData: {
							fields: [
								{ name: "a", col: 1, Type: { IsBundle: false } }
							]
						},
					displayCellRenderer: input.displayCellRenderer,
					editCellRenderer: input.editCellRenderer
				}));
			} else {
				wrap.innerHTML = dialogArguments.editCellRenderer(field).input.outerHTML;
			}
			form.appendChild(wrap);
		});
		document.getElementById("dynamic-data-modal").appendChild(form);
		function onSubmit () {
			dialogArguments.onSubmit(library.dialogFormToJSON());
			window.close();
		}
		var button = library.createElement({
			tagName: "input",
			props: { type: "submit",
			onclick: function (e) {
				onSubmit();
			}
			 }
		});
		document.getElementById("dynamic-data-modal").appendChild(button);
	} catch(e) {
		document.write(e.message);
	}
	</script>
</html>
